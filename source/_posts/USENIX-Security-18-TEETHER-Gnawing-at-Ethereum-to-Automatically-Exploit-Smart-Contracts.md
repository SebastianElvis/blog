---
title: >-
  USENIX Security'18 - TEETHER: Gnawing at Ethereum to Automatically Exploit Smart Contracts
date: 2018-11-08 19:56:39
categories:
- paper reading
tags:
- USENIX Security
- Blockchain
- Smart Contracts
- Security
---

# Info

- **Title**: TEETHER: Gnawing at Ethereum to Automatically Exploit Smart Contracts
- **Conference**: USENIX Security
- **Year**: 2018
- **Topic**: Cryptography and Security (cs.CR)
- **URL**: https://www.usenix.org/system/files/conference/usenixsecurity18/sec18-krupp.pdf
- **Source code**: No


# Addressed Problems

- Smart contracts provide an opportune setting for attackers, as security vulnerabilities are tightly intertwined with financial gain.
- Smart contracts are vulnerable
  - Solidity is more error-prone than the simple checks that can be specified in Bitcoin.
  - Once deployed, smart contracts are immutable and cannot be patched or updated. This causes an unparalleled coupling of software vulnerabilities and financial loss.



# Solution

- We provide a generic definition of vulnerable contracts, based on low-level EVM instructions.
- We propose a methodology to find vulnerable execution traces in a contract and employ symbolic execution to automatically create an exploit.
- Develop a system TEETHER for automatic vulnerability discovery and automatic exploit generation
- To demonstrate the utility of our methodology, we finally perform a large-scale analysis of 38757 unique contracts extracted from the blockchain.


# Methodology

- **Section 3** provide a generic definition of vulnerable contracts, based on low-level EVM instructions
  1. Critical Instructions
    1. Direct value transfer: **CALL**, **SELFDESTRUCT** *gas*, *to*, *value*, *in_offset*, *in_size*, *out_offset*, *out_size*
    2. Code injection: **CALLCODE**, **DELEGATECALL**
    3. Defining the vulnerable state: *Critical Path*, *Vulnerable State*
  2. Storage: defining *State Changing Path*, *State Changing Transaction*, *Vulnerable*

- **Section 4** develop a tool TEETHER that provides end-to-end exploit generation from a contractâ€™s bytecode only.
  - Architecture:
    1. EVM bytecode
    2. CFG (control flow graph) recovery
    3. critical instructions
    4. path generation
    5. constraint generation
    6. exploit generation
    7. exploit
- **Section 5** provide a large-scale vulnerability analysis of 38,757 unique contracts extracted from the Ethereum blockchain.
  1. For 33,195 (85.65%) contracts, the analysis finished within the given time limit. Out of these, TEETHER was able to generate an exploit for 815 (2.10%).
  2. All exploits were validated on the private network.
  3. Case studies -> 4 categories of vulnerabilities
    - Errorneous visibility
    - Errorneous constructor
    - Semantic confusion
    - Logic flaws


# Relevance

Smart contracts is a critical part of sidechains/payment channels/PoS...
We should strictly avoid the exploits when developing those smart contract-based approaches for scaling blockchains.

# To discuss/investigate

We may be able to re-implement this framework, as it is not open-source.
We can also analyze related smart contract issues of the Lightning Network etc.